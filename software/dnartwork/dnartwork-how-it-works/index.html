<!DOCTYPE html>
<html lang="en-GB" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://ogp.me/ns/fb#" class="no-js">

<!-- Mirrored from blog.berniesumption.com/software/dnartwork/dnartwork-how-it-works/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 17 Oct 2019 12:32:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="../../../xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="/wp-content/themes/twentyfifteen/js/html5.js"></script>
	<![endif]-->
	<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Making DNArtwork #7: how does it work? &#8211; Bernie Sumption&#039;s Blog</title>
<link rel='dns-prefetch' href='http://vjs.zencdn.net/' />
<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link href='https://fonts.gstatic.com/' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="Bernie Sumption&#039;s Blog &raquo; Feed" href="../../../feed/" />
<link rel="alternate" type="application/rss+xml" title="Bernie Sumption&#039;s Blog &raquo; Comments Feed" href="../../../comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Bernie Sumption&#039;s Blog &raquo; Making DNArtwork #7: how does it work? Comments Feed" href="feed/" />
<link rel='stylesheet' id='collapseomatic-css-css'  href='../../../wp-content/plugins/jquery-collapse-o-matic/light_stylef24c.css?ver=1.6' type='text/css' media='all' />
<link rel='stylesheet' id='videojs-plugin-css'  href='../../../wp-content/plugins/videojs-html5-video-player-for-wordpress/plugin-styles433d.css?ver=4.9.11' type='text/css' media='all' />
<link rel='stylesheet' id='videojs-css'  href='http://vjs.zencdn.net/4.5/video-js.css?ver=4.9.11' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='../../../wp-content/plugins/wp-syntax/css/wp-syntax4963.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='chld_thm_cfg_parent-css'  href='../../../wp-content/themes/twentyfifteen/style433d.css?ver=4.9.11' type='text/css' media='all' />
<link rel='stylesheet' id='twentyfifteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Noto+Sans%3A400italic%2C700italic%2C400%2C700%7CNoto+Serif%3A400italic%2C700italic%2C400%2C700%7CInconsolata%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../../wp-content/themes/twentyfifteen/genericons/genericonscf1b.css?ver=3.2' type='text/css' media='all' />
<link rel='stylesheet' id='twentyfifteen-style-css'  href='../../../wp-content/themes/bernie-2015-blog-theme/style433d.css?ver=4.9.11' type='text/css' media='all' />
<style id='twentyfifteen-style-inline-css' type='text/css'>

			.post-navigation .nav-previous { background-image: url(../../../wp-content/uploads/2016/09/dnartwork-comp-print-with-bernie.jpg); }
			.post-navigation .nav-previous .post-title, .post-navigation .nav-previous a:hover .post-title, .post-navigation .nav-previous .meta-nav { color: #fff; }
			.post-navigation .nav-previous a:before { background-color: rgba(0, 0, 0, 0.4); }
		
			.post-navigation .nav-next { background-image: url(../../../wp-content/uploads/2016/09/dnartwork-first-print-closeup-825x510.jpg); border-top: 0; }
			.post-navigation .nav-next .post-title, .post-navigation .nav-next a:hover .post-title, .post-navigation .nav-next .meta-nav { color: #fff; }
			.post-navigation .nav-next a:before { background-color: rgba(0, 0, 0, 0.4); }
		
</style>
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfifteen-ie-css'  href='/wp-content/themes/twentyfifteen/css/ie.css?ver=20141010' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentyfifteen-ie7-css'  href='/wp-content/themes/twentyfifteen/css/ie7.css?ver=20141010' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='../../../wp-content/plugins/swfobj/swfobjectdc8c.js?ver=2.2'></script>
<script type='text/javascript' src='../../../wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../../../wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<script type='text/javascript' src='../../../wp-content/plugins/wp-hide-post/public/js/wp-hide-post-public6471.js?ver=2.0.10'></script>
<link rel='https://api.w.org/' href='../../../wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc0db0.php?rsd" />
<link rel='prev' title='Making DNArtwork #6: the first art print, hot off the press' href='../dnartwork-first-art-print/' />
<link rel='next' title='Project: DNArtwork' href='../' />
<meta name="generator" content="WordPress 4.9.11" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../../../index6dad.html?p=989' />
<link rel="alternate" type="application/json+oembed" href="../../../wp-json/oembed/1.0/embedc253.json?url=https%3A%2F%2Fblog.berniesumption.com%2Fsoftware%2Fdnartwork%2Fdnartwork-how-it-works%2F" />
<link rel="alternate" type="text/xml+oembed" href="../../../wp-json/oembed/1.0/embed7a54?url=https%3A%2F%2Fblog.berniesumption.com%2Fsoftware%2Fdnartwork%2Fdnartwork-how-it-works%2F&amp;format=xml" />

		<script type="text/javascript"> document.createElement("video");document.createElement("audio");document.createElement("track"); </script>
				<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><!-- BEGIN GADWP v5.1.2.5 Universal Analytics - https://deconf.com/google-analytics-dashboard-wordpress/ -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-19810778-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- END GADWP Universal Analytics -->

<!-- START - Facebook Open Graph, Google+ and Twitter Card Tags 2.1.3 -->
 <!-- Facebook Open Graph -->
  <meta property="og:locale" content="en_GB"/>
  <meta property="og:site_name" content="Bernie Sumption&#039;s Blog"/>
  <meta property="og:title" content="Making DNArtwork #7: how does it work?"/>
  <meta property="og:url" content="https://blog.berniesumption.com/software/dnartwork/dnartwork-how-it-works/"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In this post I&#039;ll explain how this artwork is created from your DNA. It&#039;s going to get quite technical, but I&#039;ve tried to include enough information that the interested layman can understand it too, perhaps with a little googling."/>
  <meta property="article:published_time" content="2016-12-14T22:10:08+00:00"/>
  <meta property="article:modified_time" content="2019-10-17T08:06:34+00:00" />
  <meta property="og:updated_time" content="2019-10-17T08:06:34+00:00" />
  <meta property="article:section" content="DNArtwork"/>
 <!-- Google+ / Schema.org -->
  <meta itemprop="name" content="Making DNArtwork #7: how does it work?"/>
  <meta itemprop="description" content="In this post I&#039;ll explain how this artwork is created from your DNA. It&#039;s going to get quite technical, but I&#039;ve tried to include enough information that the interested layman can understand it too, perhaps with a little googling."/>
 <!-- Twitter Cards -->
  <meta name="twitter:title" content="Making DNArtwork #7: how does it work?"/>
  <meta name="twitter:url" content="https://blog.berniesumption.com/software/dnartwork/dnartwork-how-it-works/"/>
  <meta name="twitter:card" content="summary_large_image"/>
 <!-- SEO -->
  <meta name="description" content="In this post I&#039;ll explain how this artwork is created from your DNA. It&#039;s going to get quite technical, but I&#039;ve tried to include enough information that the interested layman can understand it too, perhaps with a little googling."/>
 <!-- Misc. tags -->
<!-- END - Facebook Open Graph, Google+ and Twitter Card Tags 2.1.3 -->
	
</head>

<body class="post-template-default single single-post postid-989 single-format-standard">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<div id="sidebar" class="sidebar">
		<header id="masthead" class="site-header" role="banner">
			<div class="site-branding">
										<p class="site-title"><a href="../../../" rel="home">Bernie Sumption&#039;s Blog</a></p>
											<p class="site-description">Various writings on software development and photography</p>
									<button class="secondary-toggle">Menu and widgets</button>
			</div><!-- .site-branding -->
		</header><!-- .site-header -->

			<div id="secondary" class="secondary">

		
		
					<div id="widget-area" class="widget-area" role="complementary">
				<aside id="categories-2" class="widget widget_categories"><h2 class="widget-title">Categories</h2>		<ul>
	<li class="cat-item cat-item-7"><a href="../../../category/photography/" >Photography</a> (12)
</li>
	<li class="cat-item cat-item-1"><a href="../../../category/software/" >Software</a> (29)
<ul class='children'>
	<li class="cat-item cat-item-14"><a href="../../../category/software/dnartwork/" >DNArtwork</a> (8)
</li>
</ul>
</li>
	<li class="cat-item cat-item-8"><a href="../../../category/urandom/" >urandom</a> (1)
</li>
		</ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widget-title">Recent Posts</h2>		<ul>
											<li>
					<a href="../../building-reliable-user-interfaces/">Strategies for building reliable user interfaces</a>
									</li>
											<li>
					<a href="../dnartwork-generating-realistic-painted-shapes/">Making DNArtwork #8: Generating realistic painted shapes on-demand</a>
									</li>
											<li>
					<a href="../">Project: DNArtwork</a>
									</li>
											<li>
					<a href="index.html">Making DNArtwork #7: how does it work?</a>
									</li>
											<li>
					<a href="../dnartwork-first-art-print/">Making DNArtwork #6: the first art print, hot off the press</a>
									</li>
					</ul>
		</aside><aside id="archives-2" class="widget widget_archive"><h2 class="widget-title">Archives</h2>		<ul>
			<li><a href='../../../2017/09/'>September 2017</a></li>
	<li><a href='../../../2016/12/'>December 2016</a></li>
	<li><a href='../../../2016/09/'>September 2016</a></li>
	<li><a href='../../../2016/07/'>July 2016</a></li>
	<li><a href='../../../2016/06/'>June 2016</a></li>
	<li><a href='../../../2015/11/'>November 2015</a></li>
	<li><a href='../../../2015/10/'>October 2015</a></li>
	<li><a href='../../../2015/04/'>April 2015</a></li>
	<li><a href='../../../2015/03/'>March 2015</a></li>
	<li><a href='../../../2015/02/'>February 2015</a></li>
	<li><a href='../../../2015/01/'>January 2015</a></li>
	<li><a href='../../../2011/10/'>October 2011</a></li>
	<li><a href='../../../2011/05/'>May 2011</a></li>
	<li><a href='../../../2011/04/'>April 2011</a></li>
	<li><a href='../../../2010/11/'>November 2010</a></li>
	<li><a href='../../../2010/10/'>October 2010</a></li>
	<li><a href='../../../2010/09/'>September 2010</a></li>
	<li><a href='../../../2008/04/'>April 2008</a></li>
	<li><a href='../../../2007/11/'>November 2007</a></li>
	<li><a href='../../../2007/03/'>March 2007</a></li>
		</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widget-title">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">bernie</span> on <a href="../../daphnes-tweeting-catflap/index.html#comment-24406">Daphne&#8217;s tweeting catflap</a></li><li class="recentcomments"><span class="comment-author-link">Nick Battle</span> on <a href="../../daphnes-tweeting-catflap/index.html#comment-24404">Daphne&#8217;s tweeting catflap</a></li><li class="recentcomments"><span class="comment-author-link">bernie</span> on <a href="../../on-abandoning-gulp/index.html#comment-23795">On abandoning Gulp</a></li><li class="recentcomments"><span class="comment-author-link">NotAScriptKiddy</span> on <a href="../../on-abandoning-gulp/index.html#comment-23794">On abandoning Gulp</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://www.flickr.com/photos/judeapollo' rel='external nofollow' class='url'>Rory Melough</a></span> on <a href="../../../photography/depth-of-field-for-geeks/index.html#comment-21881">Bernie&#8217;s Better Guide to Depth of Field for Geeks Who Want to be Digital Artists</a></li></ul></aside>			</div><!-- .widget-area -->
		
	</div><!-- .secondary -->

	</div><!-- .sidebar -->

	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-989" class="post-989 post type-post status-publish format-standard hentry category-dnartwork">
	
	<header class="entry-header">
		<h1 class="entry-title">Making DNArtwork #7: how does it work?</h1>	</header><!-- .entry-header -->

	<div class="entry-content">
		<p><em>This article is available <a href="../../../translations/dnartwork-how-it-works-romanian/">in Romanian</a> thanks to Irina Vasilescu and <a href="../../../translations/dnartwork-how-it-works-czech/">in Czech</a> thanks to Barbora Lebedova.</em></p>
<p>This article is part of a series documenting my project to make artwork from DNA. In the <a href="../dnartwork-first-art-print/">last article</a> I showed off what the artwork looks like. In this post I&#8217;ll explain how I analyse an individual&#8217;s DNA to extract the information needed for an artwork.</p>
<p>It&#8217;s going to get quite technical, but I&#8217;ve tried to include enough information that the interested layman can understand it too, perhaps with a little googling.</p>
<p><span id="more-989"></span></p>
<p>A brief recap. Right back at the start of this project I <a href="../dnartwork-visual-style/">decided</a> that my genetic artworks will consist of a number of distinct shapes. The more related two people are, the more objects will appear in both their artworks. Have a look at these two artworks:</p>
<p><img class="aligncenter size-full wp-image-994" src="../../../wp-content/uploads/2016/12/dnart-relation-composite.jpg" alt="dnart-relation-composite" width="1200" height="449" srcset="/wp-content/uploads/2016/12/dnart-relation-composite.jpg 1200w, /wp-content/uploads/2016/12/dnart-relation-composite-300x112.jpg 300w, /wp-content/uploads/2016/12/dnart-relation-composite-768x287.jpg 768w, /wp-content/uploads/2016/12/dnart-relation-composite-1024x383.jpg 1024w" sizes="(max-width: 1200px) 100vw, 1200px" /></p>
<p>Each of the 12 shapes has a unique personality and can easily be distinguished from the others. A few seconds looking at both artworks above and you can see that some shapes appear in the same position in both artworks (e.g. the top left shape) and some are unique to each (the bottom left shape). This is what you&#8217;d expect the artworks of two siblings to look like.</p>
<p>Let&#8217;s say we have a collection of ten thousand unique shapes that each have a sufficiently distinct personality that it&#8217;s easy to recognise when the same shape appears in two paintings. Exactly how we create those shapes is a subject for another post. The task at hand is to take your DNA and boil it down into a list of numbers between 1 and 10,000, so that you share more of the numbers with a close relative than with an unrelated person.</p>
<p>I call this list of numbers the <em>DNArtwork signature</em>. It is safe to share publicly since it contains no sensitive information, except of course that if two people both share their DNArtwork signatures then you can tell how related they are. Here you go, here&#8217;s mine:</p>
<blockquote><p>9083, 2302, 1083, 1735, 5474, 1728, 9925, 1231, 95, 7831, 1526, 1505, 729, 4866, 3778, 2161, 20, 8178, 3972, 3103, 9332, 9859, 9757</p></blockquote>
<p>My algorithm for creating the DNArwork signature is, as far as I&#8217;m aware, the only really original idea I&#8217;ve contributed to this project, and it&#8217;s what sets this project apart from other artwork created from DNA.</p>
<h2>Part 1: a quick primer on SNP genetics</h2>
<p>In order to understand the description of the DNArtwork signature algorithm later in this article, you need to know some basics about DNA. If you think that SNP stands for Scottish National Party then you should read this section.</p>
<p>DNA is a massive molecule made from a string of smaller molecules called nucleotides. There are 4 nucleotides: Adenine, Cytosine, Guanine and Thymine, referred as A, C, G and T. Each nucleotide is about 13 atoms in size, think of them as the letters that spell out sentences in a coded genetic language.</p>
<p>Your genome is about 3 billion letters long and split up into 23 lengths of DNA called chromosomes. Chromosomes are large enough that you can see them under a microscope, and they look like this:</p>
<p><img class="aligncenter size-full wp-image-995" src="../../../wp-content/uploads/2016/12/HumanChromosomesChromomycinA3.jpg" alt="humanchromosomeschromomycina3" width="453" height="438" srcset="/wp-content/uploads/2016/12/HumanChromosomesChromomycinA3.jpg 453w, /wp-content/uploads/2016/12/HumanChromosomesChromomycinA3-300x290.jpg 300w" sizes="(max-width: 453px) 100vw, 453px" /></p>
<p>Because DNA molecules are continuous strings of letters, it&#8217;s possibly to identify any position on that chromosome by counting from one end of the chromosome, so for example at position 8,907,307 on chromosome 3 you have a A. This position is called a locus, or loci in plural. Each chromosome is roughly symmetrical, having two copies of your DNA. One copy comes from your mother and the other from your father, and they&#8217;re <em>almost</em> identical. In fact, your DNA sequence is almost identical to every other human &#8211; only about one in 300 loci have been found to vary between individuals.</p>
<p>Earlier I told you that at position 8,907,307 on chromosome 3 you have an A, and I could do that because position 8,907,307 on chromosome 3 is one of those boring locations that always has the same letter in humans. Everyone has an A, and for that reason nobody has thought to call this locus anything other than &#8220;position 8,907,307 on chromosome 3&#8221;. The locus next door however is a different beast. Position 8,907,308 on chromosome 3 has a &#8220;Single Nucleotide Polymorphism&#8221; or SNP for short, meaning that it has been observed to be different between some people. This particular locus can have either an A or a G, which are referred to as the two possible alleles. Since you have two copies of your DNA one from each parent, you can have either two As, two Gs, or one of each. This makes the locus interesting enough that scientists have given it the pithy name rs180498, to save them from having to say &#8220;position 8,907,308 on chromosome 3&#8221; all the time.</p>
<p>Like most SNPs, we have no idea what rs180498 does, or indeed if it does anything at all, so it has an extremely boring <a href="http://snpedia.com/index.php/Rs180498">entry in SNPedia</a>. Some SNPs are more interesting, like <a href="http://snpedia.com/index.php/Rs1815739">rs1815739</a> which can make you a better sprinter, or <a href="https://www.snpedia.com/index.php/Rs7495174">rs7495174</a> which can change your eye colour.</p>
<p>It&#8217;s rare that both alleles of an SNP will be equally common. The more common allele is called the major allele and the less common one the minor allele. In the case of our boring SNP rs180498, the minor allele is A with a frequency of 0.167, meaning that 16.7% of DNA strands will have an A and the remaining 88.3% will have a G. These frequency figures are averages, and may vary between populations. In fact, our boring allele rs180498/A has a frequency of 13% among western Europeans and 41% among Japanese people, according to the 1000 Genomes project.</p>
<p>The DNArtwork signature algorithm relies on looking for relatively rare alleles &#8211; ones with a minor allele frequency of around 2%. I call these &#8220;marker alleles&#8221; because having one is a distinctive feature of your genome that can be used to distinguish you from others.</p>
<p>OK, now you know enough about DNA to follow how the DNArtwork signature algorithm works.</p>
<h2>Part 2: the DNArtwork Signature Algorithm</h2>
<p><iframe src="https://www.youtube.com/embed/Z4cEfEgNvwY?rel=0" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<p>The algorithm consists of a preparation phase that is done once before anybody is tested, then an analysis stage that is done on a person&#8217;s DNA to generate their DNArtwork signature.</p>
<h4>Preparation phase</h4>
<p>Generate a list &#8220;marker alleles&#8221; &#8211; SNPs with low minor allele frequencies across all ethnicities. I use these steps:</p>
<ol>
<li>Let <code>N</code> be the length of the list of numbers that is the DNArtwork signature and <code>M</code> be the maximum value of each number. These will be chosen based on the creative requirements of the project, and for my project <code>N=23</code> and <code>M=4600</code> because each artwork has 23 shapes and there are 4600 different possible shapes.</li>
<li>Start with the set of SNPs that are tested by all of the genetic testing companies that the project must support. In my case it&#8217;s 23andme, ancestry.com and National Genographic. All of these companies test a slightly different set of SNPs but there is a large overlap.</li>
<li>Using population frequency data from the 1000 Genomes project via <a href="https://en.wikipedia.org/wiki/International_HapMap_Project">HapMap</a>, discard any SNPs with a minor allele frequency less than 1% in any ethnicity. This is because DNA tests are not perfectly accurate, so the rarer an allele is the more likely that its appearance in your results is a testing error not a real result. This is <a href="https://www.math.hmc.edu/funfacts/ffiles/30002.6.shtml">Bayes&#8217;s Theorem</a> and is an important consideration when testing for rare medical conditions.</li>
<li>If <code>N=23</code> then use actual chromosomes for this process. Otherwise divide the genome into <code>N</code> equal length sections and consider these to be &#8220;chromosomes&#8221; for the purposes of the rest of this algorithm.</li>
<li>Sort the alleles in each chromosome by the highest minor allele frequencies in any HapMap populations, with rarer alleles first. Using the highest frequency is important &#8211; if we used the average frequency, we may end up with markers that are rare on average but very common among Koreans for example, so that every Korean person will predictably share a number in their DNArtwork signature.</li>
<li>Take the first <code>M÷N</code> alleles from each chromosome.</li>
<li>Calculate the probability that an individual will fail to have any marker allele for at least one chromosome. * If this probability is unacceptably high, either increase <code>M</code> or return to step 6 but take every other allele, or every third allele, or every nth allele in order to incorporate more common markers.</li>
<li>Randomly assign an identifier number between 1 and <code>M</code> to each allele, so that each number is used for exactly one allele. This randomisation step means that, even if all numbers are not equally common, the numbers are at least approximately evenly distributed between 1 and <code>M</code>.</li>
</ol>
<p>The use of distinct <code>M</code> and <code>N</code> values and the random assignment of the identifier number means that DNArtwork signatures are not comparable between creative projects that use this algorithm, unless they have cooperated to share the preparation phase of the algorithm.</p>
<p>* When combining independent probabilities, if the chance of an event happening at an opportunity is <code>P</code>, the chance of it happening twice in two consecutive opportunities is <code>P<sup>2</sup></code>. The chance of any individual not having a specific marker allele is  <code>1-frequency</code>, so the chance of an individual not having any marker is the product of  <code>1-frequency</code> for each marker on the chromosome. For example, if you have 200 markers each with frequency 0.02, then the chance of failing to have one marker is <span style="font-family: Inconsolata, monospace;">1-0.02 = 0.98 = 98%</span>, and the chance of failing to have all 200 markers is <span style="font-family: Inconsolata, monospace;">0.98<sup>200</sup> = 0.018 = 1.8%</span>.</p>
<h4>Analysis phase</h4>
<p>Given a subject&#8217;s DNA test results:</p>
<ol>
<li>Perform validation on the results file to make sure that it contains sensible data. In my case I check that the file has a valid result for at least 50% of the marker allele SNPs. Lower values may indicate a corrupted input file, contaminated or non-human DNA used for the testing process, laboratory error, or any of the other fun fun causes of failure that DNA testing companies have to deal with on a daily basis.</li>
<li>Take the results for chromosome 1 only</li>
<li>Proceed through the list of marker alleles until you find a SNP for which the subject has at least one copy of the minor allele.</li>
<li>If you get to the end of the list and there are no matching alleles, choose the last allele on the list. This should happen very rarely*.</li>
<li>Append the identifier of that allele to the DNArtwork signature list.</li>
<li>Do the same for the rest of the chromosomes until you have a list of N numbers</li>
</ol>
<h4>Real-world performance</h4>
<p>The <a href="http://www.personalgenomes.org/">Personal Genome Project</a> is a collection of DNA testing results kindly released by members of the public for the benefit of researchers. It contains hundreds of individuals, and a few full families.</p>
<p>Firstly, I downloaded the DNA test results of 30 people and generated genetic signatures for each of them. I looked for marker alleles that appeared more frequently than I&#8217;d expect by chance. If every person had a unique set of 23 numbers, I&#8217;d have <code>23 × 30 = 690</code> distinct numbers. In fact I had 263, indicating that each number appears about 2.5 times among the 30 subjects. The most common number appeared in 30% of subjects but there are relatively few of these common numbers: and 90% of the numbers appear in less than 10% of subjects. I was happy with these figures. Some excessively common numbers are to be expected since my minor allele frequency data is based on the 1000 Genomes project which only provides an estimate of actual global frequencies. The important thing here is that there are no numbers that reliably appear in most subjects.</p>
<p>Secondly, I downloaded two sample families, one parent with two children and one grandparent, parent, child trio. On average, these family members shared 40% of their signature numbers with close members of family, and as expected the grandparent/grandchild pair shared slightly less &#8211; 30%. Between families, subjects shared 15% of their numbers. Since both families were western ancestry Americans, some relatedness is not unexpected. Again, I&#8217;m pretty happy with these figures.</p>
<h2>Patent / copyright declaration</h2>
<p>As far as I can tell, under UK and EU law, algorithms are not subject to copyright and not eligible for patent protection. I therefore have no issue with anyone creating a software implementation of the algorithm based on the description in this article.</p>
<p>One purpose of publishing this algorithm is to define some prior art, should anyone attempt to assert ownership of it in future. This algorithm was developed independently by me (Bernie Sumption) in August 2013, first implemented in software in August 2016, and published (in this article) on 14th December 2016.</p>
	</div><!-- .entry-content -->

	
	<footer class="entry-footer">
		<span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="index.html" rel="bookmark"><time class="entry-date published" datetime="2016-12-14T22:10:08+00:00">14th December 2016</time><time class="updated" datetime="2019-10-17T08:06:34+00:00">17th October 2019</time></a></span><span class="byline"><span class="author vcard"><span class="screen-reader-text">Author </span><a class="url fn n" href="../../../author/bernie/">bernie</a></span></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../../../category/software/dnartwork/" rel="category tag">DNArtwork</a></span>			</footer><!-- .entry-footer -->

</article><!-- #post-## -->

<div id="comments" class="comments-area">

			<h2 class="comments-title">
			One thought on &ldquo;Making DNArtwork #7: how does it work?&rdquo;		</h2>

		
		<ol class="comment-list">
					<li id="comment-20983" class="comment even thread-even depth-1">
			<article id="div-comment-20983" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/8f6e6c828aeccd771fc397ee79c14870?s=56&amp;d=mm&amp;r=g' srcset='https://secure.gravatar.com/avatar/8f6e6c828aeccd771fc397ee79c14870?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />						<b class="fn">Asa Hakansson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="index.html#comment-20983">
							<time datetime="2016-12-16T06:53:55+00:00">
								16th December 2016 at 6:53 am							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You ROCK and this is AMAZING! </p>
<p>That is all. </p>
<p>Thanks<br />
Åsa</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
			<p class="no-comments">Comments are closed.</p>
	
	
</div><!-- .comments-area -->

	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="../dnartwork-first-art-print/" rel="prev"><span class="meta-nav" aria-hidden="true">Previous</span> <span class="screen-reader-text">Previous post:</span> <span class="post-title">Making DNArtwork #6: the first art print, hot off the press</span></a></div><div class="nav-next"><a href="../" rel="next"><span class="meta-nav" aria-hidden="true">Next</span> <span class="screen-reader-text">Next post:</span> <span class="post-title">Project: DNArtwork</span></a></div></div>
	</nav>
		</main><!-- .site-main -->
	</div><!-- .content-area -->


	</div><!-- .site-content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
						<a href="https://wordpress.org/">Proudly powered by WordPress</a>
		</div><!-- .site-info -->
	</footer><!-- .site-footer -->

</div><!-- .site -->

<script type='text/javascript'>
var colomatduration = 'fast';
var colomatslideEffect = 'slideFade';
</script><script type='text/javascript' src='../../../wp-content/plugins/jquery-collapse-o-matic/js/collapse7514.js?ver=1.6.6'></script>
<script type='text/javascript' src='../../../wp-content/plugins/wp-syntax/js/wp-syntax4963.js?ver=1.1'></script>
<script type='text/javascript' src='../../../wp-content/themes/twentyfifteen/js/skip-link-focus-fixd01e.js?ver=20141010'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"<span class=\"screen-reader-text\">expand child menu<\/span>","collapse":"<span class=\"screen-reader-text\">collapse child menu<\/span>"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../wp-content/themes/twentyfifteen/js/functions8337.js?ver=20150330'></script>

</body>

<!-- Mirrored from blog.berniesumption.com/software/dnartwork/dnartwork-how-it-works/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 17 Oct 2019 12:32:49 GMT -->
</html>

<!-- Dynamic page generated in 3.239 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2019-10-17 12:31:27 -->

<!-- super cache -->